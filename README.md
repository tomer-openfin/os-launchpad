# OpenFin OS

OpenFin OS centralizes app discovery and can be customized with your own branding.

**Features**

* Customizable look and feel
* Supports custom application manifests from local and remote environments
* Searchable application directory

## Getting started

1. Clone this repository
2. `npm i`
3. `npm start`

_(alternatively, you can run the application and OpenFin separately by doing the following:)_

1. `npm run dev`
2. `npm run openfin`

## Development

### Scripts

| Script | Description |
| :--- | :--- |
| `build-storybook` | Create a static Storybook build. Creates a build artifact in `storybook-static`. |
| `build` | Build the application. Creates a build artifact in `build`. Be sure to run this with `NODE_ENV` set to `production` when deploying to production. |
| `check` | Runs `gts check`. |
| `clean` | Run `gts clean` and remove build artifacts. |
| `dev` | Run the application in development mode. |
| `docs` | Generate the API documentation. |
| `fix` | Run `gts fix`. |
| `openfin` | Run OpenFin. By default this opens the development mode application in OpenFin. |
| `serve` | Run a simulated production environment. This should be run after creating the production build artifact. |
| `start` | Start the application in development mode, and then immediately start OpenFin. |
| `storybook` | Run Storybook. |
| `storyshorts` | Update any outdated snapshots generated by Storyshots. |
| `test` | Run unit tests. |

### Environment varibles

| Variable | Description | Development only? |
| :--- | :--- | :---: |
| `API_URL` | Set the base url for the API host. | |
| `BACKEND` | API hostname to proxy requests to. | ✅ |
| `DEPLOY_LOCATION` | Set the `url` in the manifest. | |
| `ENTERPRISE` | Determine if the app should start in enterprise mode. | ✅ |
| `HOST` | Set the host for the application. | ✅ |
| `MOCK_POSTMAN_URI` | Postman mock server URI. | ✅ |
| `PORT` | Set the port for the application. | ✅ |
| `POSTMAN_API_KEY` | Postman API key. | ✅ |
| `RUNTIME_VERSION` | Set the `runtime` in the manifest. | |

### Develping on macOS

This is the preferred development environment, however as of right now you won't be able to launch applications because there is no RVM in the macOS runtime of OpenFin. If you need to test this behavior, you can run the application in Windows inside a virtual machine. Details below.

### Running the app in a virtual machine

If you want to run the application in Windows inside of a virtual machine, you'll need to set a few environment variables.

First, get the IP address of your virtual machine. You can do this by running `ifconfig` to see all network interfaces, or run:

`ifconfig | grep vmnet1 -A 2 | grep inet | awk '{print $2}'`

Then, create a `.env` file and add the following variables:

```
DEPLOY_LOCATION=http://<vmnet1 address here>:8080
HOST=<vmnet1 address here>
PORT=8080
```

Start the application on your host machine, and start OpenFin in your guest machine. The application manifest will be available at `http://<vmnet1 address here>:8080/app.json`

### Build

When the build script is run, a build artifact is created in the `build` directory.
